<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Panel - E-Voting OSIS SMAN 23 Bandung</title>
    
    <!-- Firebase SDK v9 -->
    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
        import { getAuth, signInWithEmailAndPassword, signOut, onAuthStateChanged, createUserWithEmailAndPassword } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js';
        import { getDatabase, ref, get, set, remove, onValue, off, serverTimestamp, push, transaction } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js';
        
        // Firebase Configuration
        const firebaseConfig = {
            apiKey: "AIzaSyDQEhUpqlN6co-JD3TWehVfOWa2Ku9TC_c",
            authDomain: "pemilos-a8cfe.firebaseapp.com",
            databaseURL: "https://pemilos-a8cfe-default-rtdb.asia-southeast1.firebasedatabase.app",
            projectId: "pemilos-a8cfe",
            storageBucket: "pemilos-a8cfe.firebasestorage.app",
            messagingSenderId: "1091016147879",
            appId: "1:1091016147879:web:484bdce3ef18ee284b6c82"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const database = getDatabase(app);

        // Make Firebase services globally available
        window.firebaseAuth = auth;
        window.firebaseDb = database;
        window.firebaseServices = {
            signInWithEmailAndPassword,
            signOut,
            onAuthStateChanged,
            createUserWithEmailAndPassword,
            ref,
            get,
            set,
            remove,
            onValue,
            off,
            serverTimestamp,
            push,
            transaction
        };

        // Initialize app when DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            initializeApp();
        });
    </script>
    
    <!-- Chart.js for graphs -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #f8fafc;
            color: #334155;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 1rem;
        }

        /* Login Screen Styles */
        .login-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #1e40af 0%, #3b82f6 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 9999;
        }

        .login-card {
            background: white;
            border-radius: 1rem;
            padding: 2rem;
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
            width: 100%;
            max-width: 400px;
            margin: 1rem;
        }

        .login-header {
            text-align: center;
            margin-bottom: 2rem;
        }

        .login-logo {
            width: 4rem;
            height: 4rem;
            background: #1e40af;
            border-radius: 1rem;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 2rem;
            margin: 0 auto 1rem;
        }

        .login-title {
            font-size: 1.5rem;
            font-weight: bold;
            color: #1e293b;
            margin-bottom: 0.5rem;
        }

        .login-subtitle {
            color: #64748b;
            font-size: 0.875rem;
        }

        .form-group {
            margin-bottom: 1rem;
        }

        .form-label {
            display: block;
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: #374151;
        }

        .form-input, .form-textarea, .form-select {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid #d1d5db;
            border-radius: 0.5rem;
            font-size: 0.875rem;
            transition: border-color 0.2s;
        }

        .form-input:focus, .form-textarea:focus, .form-select:focus {
            outline: none;
            border-color: #1e40af;
            box-shadow: 0 0 0 3px rgba(30, 64, 175, 0.1);
        }

        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 0.5rem;
            font-weight: 600;
            text-decoration: none;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 0.875rem;
            gap: 0.5rem;
            width: 100%;
        }

        .btn-primary {
            background: #1e40af;
            color: white;
        }

        .btn-primary:hover {
            background: #1d4ed8;
        }

        .btn-primary:disabled {
            background: #94a3b8;
            cursor: not-allowed;
        }

        .alert {
            padding: 1rem;
            border-radius: 0.5rem;
            margin-bottom: 1rem;
        }

        .alert-error {
            background: #fef2f2;
            border: 1px solid #fecaca;
            color: #dc2626;
        }

        .alert-success {
            background: #f0fdf4;
            border: 1px solid #bbf7d0;
            color: #059669;
        }

        .loading {
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 1rem;
        }

        .spinner {
            width: 1.5rem;
            height: 1.5rem;
            border: 2px solid #e2e8f0;
            border-top: 2px solid #1e40af;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .hidden { 
            display: none !important; 
        }

        /* Main App Styles (same as before but with security enhancements) */
        .header {
            background: white;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            border-bottom: 1px solid #e2e8f0;
            padding: 1rem 0;
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .logo-icon {
            width: 3rem;
            height: 3rem;
            background: #1e40af;
            border-radius: 0.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.5rem;
        }

        .logo-text h1 {
            font-size: 1.5rem;
            font-weight: bold;
            color: #1e293b;
        }

        .logo-text p {
            font-size: 0.875rem;
            color: #64748b;
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-right: 1rem;
        }

        .user-email {
            font-size: 0.875rem;
            color: #64748b;
        }

        .btn-secondary {
            background: #f1f5f9;
            color: #475569;
            border: 1px solid #e2e8f0;
            padding: 0.5rem 1rem;
        }

        .btn-secondary:hover {
            background: #e2e8f0;
        }

        .btn-danger {
            background: #dc2626;
            color: white;
            padding: 0.5rem 1rem;
        }

        .btn-danger:hover {
            background: #b91c1c;
        }

        /* Security Status Indicator */
        .security-status {
            position: fixed;
            top: 1rem;
            right: 1rem;
            background: #059669;
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 0.5rem;
            font-size: 0.75rem;
            z-index: 1000;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .security-status.warning {
            background: #d97706;
        }

        .security-status.error {
            background: #dc2626;
        }

        /* Rest of the styles remain the same as original */
        .nav {
            background: white;
            border-bottom: 1px solid #e2e8f0;
            padding: 0;
        }

        .nav-tabs {
            display: flex;
            gap: 0;
            overflow-x: auto;
        }

        .nav-tab {
            padding: 1rem 1.5rem;
            background: transparent;
            border: none;
            border-bottom: 3px solid transparent;
            cursor: pointer;
            font-weight: 600;
            color: #64748b;
            transition: all 0.2s;
            white-space: nowrap;
        }

        .nav-tab.active {
            color: #1e40af;
            border-bottom-color: #1e40af;
            background: #f8fafc;
        }

        .nav-tab:hover {
            color: #1e40af;
            background: #f8fafc;
        }

        .content {
            padding: 2rem 0;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .card {
            background: white;
            border-radius: 0.75rem;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            border: 1px solid #e2e8f0;
            overflow: hidden;
        }

        .card-header {
            padding: 1.5rem;
            border-bottom: 1px solid #e2e8f0;
            background: #f8fafc;
        }

        .card-title {
            font-size: 1.25rem;
            font-weight: bold;
            color: #1e293b;
            margin-bottom: 0.25rem;
        }

        .card-description {
            color: #64748b;
            font-size: 0.875rem;
        }

        .card-content {
            padding: 1.5rem;
        }

        .grid {
            display: grid;
            gap: 1.5rem;
        }

        .grid-2 { grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); }
        .grid-3 { grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); }
        .grid-4 { grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); }

        .stat-card {
            text-align: center;
            padding: 2rem 1rem;
        }

        .stat-number {
            font-size: 2.5rem;
            font-weight: bold;
            margin-bottom: 0.5rem;
        }

        .stat-label {
            color: #64748b;
            font-size: 0.875rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        @media (max-width: 768px) {
            .grid-2, .grid-3, .grid-4 {
                grid-template-columns: 1fr;
            }
            
            .nav-tabs {
                flex-wrap: wrap;
            }
        }
    </style>
</head>
<body>
    <!-- Security Status Indicator -->
    <div id="security-status" class="security-status hidden">
        <span>üîí</span>
        <span id="security-text">Secure Connection</span>
    </div>

    <!-- Login Screen -->
    <div id="login-screen" class="login-screen">
        <div class="login-card">
            <div class="login-header">
                <div class="login-logo">üîê</div>
                <h1 class="login-title">Admin Login</h1>
                <p class="login-subtitle">E-Voting OSIS SMAN 23 Bandung</p>
            </div>
            
            <div id="login-alert" class="alert alert-error hidden">
                <span id="login-error-message"></span>
            </div>

            <form id="login-form">
                <div class="form-group">
                    <label class="form-label">Email Admin</label>
                    <input type="email" id="admin-email" class="form-input" required 
                           placeholder="admin@sman23bandung.sch.id">
                </div>
                <div class="form-group">
                    <label class="form-label">Password</label>
                    <input type="password" id="admin-password" class="form-input" required>
                </div>
                <button type="submit" class="btn btn-primary" id="login-btn">
                    <span id="login-btn-text">üîì Login</span>
                    <div id="login-spinner" class="spinner hidden"></div>
                </button>
            </form>

            <div style="margin-top: 1rem; padding-top: 1rem; border-top: 1px solid #e2e8f0;">
                <p style="font-size: 0.75rem; color: #64748b; text-align: center;">
                    Hanya admin yang terotorisasi yang dapat mengakses panel ini.
                </p>
            </div>
        </div>
    </div>

    <!-- Main Application (hidden by default) -->
    <div id="main-app" class="hidden">
        <!-- Header -->
        <header class="header">
            <div class="container">
                <div class="header-content">
                    <div class="logo">
                        <div class="logo-icon">‚öôÔ∏è</div>
                        <div class="logo-text">
                            <h1>Admin Panel</h1>
                            <p>E-Voting OSIS SMAN 23 Bandung</p>
                        </div>
                    </div>
                    <div style="display: flex; align-items: center; gap: 1rem;">
                        <div class="user-info">
                            <span class="user-email" id="user-email"></span>
                        </div>
                        <button class="btn btn-secondary" onclick="window.open('main.html', '_blank')">
                            üó≥Ô∏è Lihat Website
                        </button>
                        <button class="btn btn-danger" onclick="logout()">
                            üö™ Logout
                        </button>
                    </div>
                </div>
            </div>
        </header>

        <!-- Navigation -->
        <nav class="nav">
            <div class="container">
                <div class="nav-tabs">
                    <button class="nav-tab active" onclick="switchTab('dashboard')">üìä Dashboard</button>
                    <button class="nav-tab" onclick="switchTab('security')">üîí Keamanan</button>
                    <button class="nav-tab" onclick="switchTab('votes')">üó≥Ô∏è Kelola Suara</button>
                    <button class="nav-tab" onclick="switchTab('candidates')">üë• Kelola Kandidat</button>
                    <button class="nav-tab" onclick="switchTab('settings')">‚öôÔ∏è Pengaturan</button>
                </div>
            </div>
        </nav>

        <!-- Content -->
        <main class="content">
            <div class="container">
                <!-- Dashboard Tab -->
                <div id="dashboard-tab" class="tab-content active">
                    <div class="grid grid-4" style="margin-bottom: 2rem;">
                        <div class="card">
                            <div class="stat-card">
                                <div class="stat-number" style="color: #1e40af;" id="total-votes-stat">-</div>
                                <div class="stat-label">Total Suara</div>
                            </div>
                        </div>
                        <div class="card">
                            <div class="stat-card">
                                <div class="stat-number" style="color: #059669;" id="participation-stat">-</div>
                                <div class="stat-label">Partisipasi</div>
                            </div>
                        </div>
                        <div class="card">
                            <div class="stat-card">
                                <div class="stat-number" style="color: #7c3aed;">3</div>
                                <div class="stat-label">Kandidat</div>
                            </div>
                        </div>
                        <div class="card">
                            <div class="stat-card">
                                <div class="stat-number" style="color: #dc2626;" id="remaining-stat">-</div>
                                <div class="stat-label">Belum Vote</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Security Tab -->
                <div id="security-tab" class="tab-content">
                    <div class="grid grid-2">
                        <div class="card">
                            <div class="card-header">
                                <div class="card-title">üîí Status Keamanan</div>
                                <div class="card-description">Informasi keamanan sistem</div>
                            </div>
                            <div class="card-content">
                                <div id="security-info">
                                    <div style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 1rem;">
                                        <span style="color: #059669;">‚úÖ</span>
                                        <span>Firebase Authentication Aktif</span>
                                    </div>
                                    <div style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 1rem;">
                                        <span style="color: #059669;">‚úÖ</span>
                                        <span>Koneksi HTTPS Aman</span>
                                    </div>
                                    <div style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 1rem;">
                                        <span style="color: #059669;">‚úÖ</span>
                                        <span>Database Rules Terkonfigurasi</span>
                                    </div>
                                    <div style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 1rem;">
                                        <span id="session-status" style="color: #059669;">‚úÖ</span>
                                        <span>Sesi Login Valid</span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="card">
                            <div class="card-header">
                                <div class="card-title">üë• Manajemen Admin</div>
                                <div class="card-description">Kelola akses admin</div>
                            </div>
                            <div class="card-content">
                                <form id="add-admin-form">
                                    <div class="form-group">
                                        <label class="form-label">Email Admin Baru</label>
                                        <input type="email" id="new-admin-email" class="form-input" 
                                               placeholder="admin2@sman23bandung.sch.id" required>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Password Sementara</label>
                                        <input type="password" id="new-admin-password" class="form-input" 
                                               minlength="6" required>
                                    </div>
                                    <button type="submit" class="btn btn-primary">
                                        ‚ûï Tambah Admin
                                    </button>
                                </form>
                            </div>
                        </div>
                    </div>

                    <div class="card">
                        <div class="card-header">
                            <div class="card-title">üìä Log Aktivitas</div>
                            <div class="card-description">Riwayat aktivitas admin</div>
                        </div>
                        <div class="card-content">
                            <div id="activity-log">
                                <!-- Activity log will be populated here -->
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Other tabs remain the same but with enhanced security checks -->
                <div id="votes-tab" class="tab-content">
                    <div class="card">
                        <div class="card-header">
                            <div class="card-title">üó≥Ô∏è Kelola Data Suara</div>
                            <div class="card-description">Tambah, edit, atau hapus data suara (Akses Terbatas)</div>
                        </div>
                        <div class="card-content">
                            <div class="alert alert-warning">
                                <strong>‚ö†Ô∏è Peringatan Keamanan:</strong> Semua perubahan akan dicatat dalam log aktivitas.
                            </div>
                            <!-- Vote management content -->
                        </div>
                    </div>
                </div>

                <div id="candidates-tab" class="tab-content">
                    <div class="card">
                        <div class="card-header">
                            <div class="card-title">üë• Kelola Kandidat</div>
                            <div class="card-description">Manajemen data kandidat (Akses Terbatas)</div>
                        </div>
                        <div class="card-content">
                            <!-- Candidates management content -->
                        </div>
                    </div>
                </div>

                <div id="settings-tab" class="tab-content">
                    <div class="card">
                        <div class="card-header">
                            <div class="card-title">‚öôÔ∏è Pengaturan Sistem</div>
                            <div class="card-description">Konfigurasi sistem (Super Admin Only)</div>
                        </div>
                        <div class="card-content">
                            <!-- Settings content -->
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script>
        // Global variables
        let currentUser = null;
        let currentTab = 'dashboard';
        let securityCheckInterval = null;

        // Initialize the application
        function initializeApp() {
            setupAuthStateListener();
            setupSecurityChecks();
            logActivity('App initialized');
        }

        // Setup authentication state listener
        function setupAuthStateListener() {
            const { onAuthStateChanged } = window.firebaseServices;
            
            onAuthStateChanged(window.firebaseAuth, (user) => {
                if (user) {
                    // User is signed in
                    currentUser = user;
                    showMainApp();
                    updateUserInfo();
                    logActivity(`Admin logged in: ${user.email}`);
                } else {
                    // User is signed out
                    currentUser = null;
                    showLoginScreen();
                }
            });
        }

        // Setup security monitoring
        function setupSecurityChecks() {
            // Check security status every 30 seconds
            securityCheckInterval = setInterval(() => {
                checkSecurityStatus();
            }, 30000);

            // Initial security check
            checkSecurityStatus();
        }

        // Check security status
        function checkSecurityStatus() {
            const statusEl = document.getElementById('security-status');
            const textEl = document.getElementById('security-text');
            
            if (!statusEl || !textEl) return;

            // Check HTTPS
            if (location.protocol !== 'https:' && location.hostname !== 'localhost') {
                statusEl.className = 'security-status error';
                textEl.textContent = 'Koneksi Tidak Aman';
                statusEl.classList.remove('hidden');
                return;
            }

            // Check authentication
            if (!currentUser) {
                statusEl.className = 'security-status warning';
                textEl.textContent = 'Tidak Terautentikasi';
                statusEl.classList.remove('hidden');
                return;
            }

            // All checks passed
            statusEl.className = 'security-status';
            textEl.textContent = 'Koneksi Aman';
            statusEl.classList.remove('hidden');
        }

        // Show login screen
        function showLoginScreen() {
            document.getElementById('login-screen').classList.remove('hidden');
            document.getElementById('main-app').classList.add('hidden');
        }

        // Show main application
        function showMainApp() {
            document.getElementById('login-screen').classList.add('hidden');
            document.getElementById('main-app').classList.remove('hidden');
            loadDashboard();
        }

        // Update user information in header
        function updateUserInfo() {
            const userEmailEl = document.getElementById('user-email');
            if (userEmailEl && currentUser) {
                userEmailEl.textContent = currentUser.email;
            }
        }

        // Handle login form submission
        document.getElementById('login-form').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const email = document.getElementById('admin-email').value;
            const password = document.getElementById('admin-password').value;
            const loginBtn = document.getElementById('login-btn');
            const loginBtnText = document.getElementById('login-btn-text');
            const loginSpinner = document.getElementById('login-spinner');
            const alertEl = document.getElementById('login-alert');
            const errorMessageEl = document.getElementById('login-error-message');

            // Show loading state
            loginBtn.disabled = true;
            loginBtnText.classList.add('hidden');
            loginSpinner.classList.remove('hidden');
            alertEl.classList.add('hidden');

            try {
                const { signInWithEmailAndPassword } = window.firebaseServices;
                await signInWithEmailAndPassword(window.firebaseAuth, email, password);
                
                // Success - the auth state listener will handle the UI update
                logActivity(`Successful login attempt: ${email}`);
                
            } catch (error) {
                console.error('Login error:', error);
                
                let errorMessage = 'Login gagal. Periksa email dan password Anda.';
                
                switch (error.code) {
                    case 'auth/user-not-found':
                        errorMessage = 'Email admin tidak ditemukan.';
                        break;
                    case 'auth/wrong-password':
                        errorMessage = 'Password salah.';
                        break;
                    case 'auth/invalid-email':
                        errorMessage = 'Format email tidak valid.';
                        break;
                    case 'auth/too-many-requests':
                        errorMessage = 'Terlalu banyak percobaan login. Coba lagi nanti.';
                        break;
                }

                errorMessageEl.textContent = errorMessage;
                alertEl.classList.remove('hidden');
                
                logActivity(`Failed login attempt: ${email} - ${error.code}`);
            } finally {
                // Reset loading state
                loginBtn.disabled = false;
                loginBtnText.classList.remove('hidden');
                loginSpinner.classList.add('hidden');
            }
        });

        // Handle logout
        async function logout() {
            if (!confirm('Yakin ingin logout?')) {
                return;
            }

            try {
                const { signOut } = window.firebaseServices;
                await signOut(window.firebaseAuth);
                
                logActivity(`Admin logged out: ${currentUser?.email}`);
                
                // Clear any intervals
                if (securityCheckInterval) {
                    clearInterval(securityCheckInterval);
                }
                
            } catch (error) {
                console.error('Logout error:', error);
                alert('Error saat logout. Silakan coba lagi.');
            }
        }

        // Add new admin (for super admin only)
        document.getElementById('add-admin-form').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            if (!currentUser) {
                alert('Anda harus login terlebih dahulu.');
                return;
            }

            const email = document.getElementById('new-admin-email').value;
            const password = document.getElementById('new-admin-password').value;

            try {
                // Note: In a production environment, you would need to use Firebase Admin SDK
                // on the server side to create users. This is just for demonstration.
                alert('Fitur ini memerlukan implementasi server-side dengan Firebase Admin SDK.');
                
                logActivity(`Attempted to create new admin: ${email}`);
                
            } catch (error) {
                console.error('Error creating admin:', error);
                alert('Error membuat admin baru.');
            }
        });

        // Log activity
        function logActivity(activity) {
            const timestamp = new Date().toLocaleString('id-ID');
            const userEmail = currentUser?.email || 'Anonymous';
            
            console.log(`[${timestamp}] ${userEmail}: ${activity}`);
            
            // In production, you would save this to the database
            // const { ref, push, serverTimestamp } = window.firebaseServices;
            // push(ref(window.firebaseDb, 'activity_logs'), {
            //     activity,
            //     user: userEmail,
            //     timestamp: serverTimestamp(),
            //     ip: 'xxx.xxx.xxx.xxx' // You would get this from server
            // });
        }

        // Tab switching with security checks
        function switchTab(tabName) {
            if (!currentUser) {
                alert('Sesi Anda telah berakhir. Silakan login kembali.');
                logout();
                return;
            }

            // Hide all tabs
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelectorAll('.nav-tab').forEach(tab => {
                tab.classList.remove('active');
            });

            // Show selected tab
            document.getElementById(tabName + '-tab').classList.add('active');
            event.target.classList.add('active');
            currentTab = tabName;

            logActivity(`Accessed tab: ${tabName}`);

            // Load tab-specific data
            switch(tabName) {
                case 'dashboard':
                    loadDashboard();
                    break;
                case 'security':
                    loadSecurityTab();
                    break;
                case 'votes':
                    loadVotes();
                    break;
                case 'candidates':
                    loadCandidates();
                    break;
                case 'settings':
                    loadSettings();
                    break;
            }
        }

        // Load dashboard (simplified version)
        function loadDashboard() {
            // Update statistics
            document.getElementById('total-votes-stat').textContent = '0';
            document.getElementById('participation-stat').textContent = '0%';
            document.getElementById('remaining-stat').textContent = '1200';
            
            logActivity('Dashboard loaded');
        }

        // Load security tab
        function loadSecurityTab() {
            const activityLog = document.getElementById('activity-log');
            if (activityLog) {
                activityLog.innerHTML = `
                    <div style="font-size: 0.875rem; color: #64748b;">
                        <p>Log aktivitas akan ditampilkan di sini dalam implementasi lengkap.</p>
                        <p>Saat ini: Monitoring keamanan aktif ‚úÖ</p>
                    </div>
                `;
            }
            
            logActivity('Security tab accessed');
        }

        // Placeholder functions for other tabs
        function loadVotes() {
            logActivity('Votes management accessed');
        }

        function loadCandidates() {
            logActivity('Candidates management accessed');
        }

        function loadSettings() {
            logActivity('Settings accessed');
        }

        // Cleanup on page unload
        window.addEventListener('beforeunload', function() {
            if (securityCheckInterval) {
                clearInterval(securityCheckInterval);
            }
            
            if (currentUser) {
                logActivity('Admin session ended');
            }
        });

        // Prevent right-click and F12 in production (optional security measure)
        if (location.hostname !== 'localhost') {
            document.addEventListener('contextmenu', e => e.preventDefault());
            document.addEventListener('keydown', e => {
                if (e.key === 'F12' || (e.ctrlKey && e.shiftKey && e.key === 'I')) {
                    e.preventDefault();
                }
            });
        }
    </script>
</body>
</html>